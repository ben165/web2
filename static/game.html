<!doctype html>
<head>
    <title>Reversi</title>
    <link rel="stylesheet" href="/styles.css">
</head>
<body>


<h3>Allgemeine Infos</h3>
GameID: "123"<br>
Player: 1


<h3>Game Board</h3>
<div id="playerField"></div>

<script>
function createBoard() {
    str = ""
    for (i=0; i<8; i++) {
        for (j=0; j<8; j++) {
            name = "b" + (8*i + j).toString()
            str += '<button id="'+ name +'" name="gameButton" class="gameButtonClass"> </button>'
        }
    str += "<br>\n"
    }
    //console.log(str)
    document.getElementById("playerField").innerHTML = str
    var refreshField = setInterval(checkChange, 1000);
}

async function getGameData() {
    const response = await fetch("/gameinfo/" + gameid);
    const gameData = await response.json();

    // update spielfeld
}


function checkChange() {
    fetch("/gameinfo/" + gameid)
    .then((response) => response.json())
    .then((state) => updateField(state))
}

function updateField(state) {
    for (i=0; i<state.length; i++) {
        if (state[i] == 1) {
            document.getElementById("b"+Number(i)).innerHTML = "X"
        } else if (state[i] == 2) {
            document.getElementById("b"+Number(i)).innerHTML = "O"
        }
    }
}


</script>


<script>
    const urlParams = new URLSearchParams(window.location.search);

    //TODO check if number is 1 or 2????
    var player = urlParams.get("player") 
    var gameid = "123" //TODO not important anymore?


    createBoard()
    const playerField = document.getElementById('playerField');

    playerField.addEventListener('click', (event) => {
    const isButton = event.target.nodeName === 'BUTTON';
    if (!isButton) {
        return;
    }

    nr = event.target.id
    nr = Number(nr.substring(1,nr.length))

    fetch("/makeMove",{
    headers: {'Accept': 'application/json', 'Content-Type': 'application/json'},
    method: "POST",
    body: JSON.stringify({pos: nr, player, gameid })
    })
})

</script>



<p id="debug"></p>





</body>
</html>

